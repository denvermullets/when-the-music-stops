<%= render 'forums/banner' %>
<!-- topic box -->
<div class='sticky z-10 flex w-full px-2 border-b top-10 bg-zinc-950 border-b-gray-700 md:px-14'>
  <div class='flex flex-row items-center justify-between w-full px-4 py-2 mx-auto space-x-4 lowercase border-l border-r border-gray-700 center text-slate-100'>
    <div>
      <%= link_to "<- #{topic.sub_forum.name}", forum_sub_forum_path(topic.sub_forum.forum, topic.sub_forum), class: 'hover:text-sky-500' %>
    </div>
    <%== pagy_nav(@pagy, link_extra: 'class="hover:text-sky-500 "') %>
  </div>
</div>
<!-- comments index view -->
<div class='flex flex-col w-full border-b border-gray-700'>
  <div class='px-2 bg-zinc-950 md:px-14'>
    <% if params[:page].nil? || params[:page] == '1'  %>
      <div class='border-l border-r border-gray-700 bg-zinc-950 '>
        <div class='p-px overflow-hidden md:rounded-full bg-gradientTopRight ring-1 ring-gray-700'>
          <div class='flex flex-col border-gray-700 text-slate-100'>
            <!-- topic post -->
            <div class="flex flex-row w-full">
              <div class='flex-col hidden w-64 px-10 py-6 border-r border-gray-700 md:flex ' >
                <% if topic.user.avatar.attached? %>
                  <div class='hidden w-20 h-20 md:block '>
                    <%= image_tag topic.user.avatar %>
                  </div>
                <% end %>
                <h5 class='mt-2 text-md'><%= link_to topic.user.username, user_show_path(topic.user.username), class: 'hover:text-sky-500' %></h5>
                <% if topic.user.display_post_count? %>
                  <h5 class='text-xs'>Posts: <%= topic.user.post_count %></h5>
                <% end %>
                <h5 class='text-xs'>Joined: <%= format_created_date(topic.user) %></h5>
                <% if topic.user.location.present? && topic.user.display_location? %>
                  <h5 class='text-xs'>Location: <%= topic.user.location %></h5>
                <% end %>
              </div>
              <div class='flex-col w-full border-gray-700'>
                <div class='px-4 py-2 border-gray-700 md:border-b'>
                  <h1 class='text-2xl'><%= topic.title %></h1>
                  <h5 class='text-xs'>
                    by <%= topic.user.username %>
                    <%= format_created_date(topic) %>
                  </h5>
                </div>
                <div class='p-4'>
                  <%= line_break(topic.body) %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
    <!-- comment post -->
    <% comments.map do |comment| %>
      <div class='border-l border-r border-gray-700 bg-zinc-950 '>
        <div class='p-px overflow-hidden md:rounded-full bg-gradientTopRight ring-1 ring-gray-700'>
          <div class='flex flex-col border-gray-700 text-slate-100'>
            <div class="flex flex-row w-full">
              <div class='flex-col hidden w-64 px-2 py-6 border-r border-gray-700 md:flex md:px-10 ' >
                <% if comment.user.avatar.attached? %>
                  <div class='hidden w-20 h-20 md:block '>
                    <%= image_tag comment.user.avatar %>
                  </div>
                <% end %>
                <h5 class='mt-2 text-md'><%= link_to comment.user.username, user_show_path(comment.user.username), class: 'hover:text-sky-500' %></h5>
                <% if comment.user.display_post_count? %>
                  <h5 class='text-xs'>Posts: <%= comment.user.post_count %></h5>
                <% end %>
                <h5 class='text-xs'>Joined: <%= format_created_date(comment.user) %></h5>
                <% if comment.user.location.present? && comment.user.display_location? %>
                  <h5 class='text-xs'>Location: <%= comment.user.location %></h5>
                <% end %>
              </div>
              <div class='flex-col w-full border-gray-700'>
                <div class='px-4 py-2 border-gray-700 md:border-b'>
                  <h1 class='text-lg'>re: <%= topic.title %></h1>
                  <h5 class='text-xs'>
                    by <%= comment.user.username %> <%= format_created_date(comment) %>
                  </h5>
                </div>
                <div class='p-4'>
                  <%= line_break(comment.body) %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
<div class='flex w-full px-2 border-b bg-zinc-950 border-b-gray-700 md:px-14'>
  <div class='flex flex-row justify-end w-full h-10 px-4 py-2 space-x-4 lowercase border-l border-r border-gray-700 text-slate-100'>
    <%== pagy_nav(@pagy, link_extra: 'class="hover:text-sky-500 "')%>
  </div>
</div>
<!-- -->
<div id='error_message' class='flex flex-row'>
</div>
<% if current_user %>
  <%= form_with scope: :comment, url: create_topic_comment_path, local: true do |form| %>
    <div class='flex w-full px-2 border-b bg-zinc-950 border-b-gray-700 md:px-14'>
      <div class='flex flex-row w-full h-full px-4 py-2 space-x-4 border-l border-r border-gray-700 text-slate-100'>
        <div class='flex flex-col w-full p-4 space-y-4 md:flex-row md:space-x-8 md:space-y-0'>
          <div class='flex flex-col w-full space-y-4'>
            <%= form.text_area :body,
            class: 'form-input w-full h-32 text-slate-50 text-xl bg-zinc-950 border-gray-700 focus:border-slate-500 focus:ring-1 focus:ring-slate-500',
            placeholder: ''
          %>
            <%= form.hidden_field :topic_id, value: topic.id %>
            <%= form.hidden_field :user_id, value: current_user.id %>
          </div>
          <div class='flex items-center justify-center basis-1/4'>
            <%= form.submit "submit",
            class: "bg-none border border-sky-500 hover:border-sky-700 hover:text-sky-700 text-sky-500 font-bold py-2 px-4 rounded-full cursor-pointer w-full h-16 md:h-24"
          %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
<% end %>
<%= render 'forums/footer' %>
